<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Primary Meta Tags -->
  <meta name="title" content="TRISH — Totally-Rad Illness Script Hub">
  <meta name="description" content="TRISH: illness-script-based Anki deck generator and study hub by Austin Murr. View spreadsheets and download curated Anki (.apkg) decks for medical study.">
  <meta name="keywords" content="TRISH, Anki, illness script, medical education, study aid, Anki decks, Anki .apkg, University of Minnesota">
  <meta name="author" content="Austin Murr">
  <meta name="robots" content="index, follow">
  <meta name="language" content="English">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="TRISH — Totally-Rad Illness Script Hub">
  <meta property="og:title" content="TRISH — Totally-Rad Illness Script Hub">
  <meta property="og:description" content="View TRISH spreadsheets and download Anki decks (.apkg). A lightweight hub for illness scripts and Anki-based study, maintained by Austin Murr.">
  <meta property="og:url" content="https://github.com/eyenerd/TRISH">
  <meta property="og:image" content="https://github.com/eyenerd/TRISH/raw/main/static/images/TRISH.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="TRISH">

  <!-- Additional SEO -->
  <meta name="theme-color" content="#2563eb">
  <!-- TRISH build/version placeholder -->
  <meta name="trish-version" content="v2026.02.17.1345">
  <meta name="msapplication-TileColor" content="#2563eb">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://ajax.googleapis.com">
  <link rel="preconnect" href="https://documentcloud.adobe.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">


  <!-- TODO: Replace with your paper title and authors -->
  <title>TRISH</title>
  
  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/x-icon" href="static/images/TRISH.png">
  <link rel="apple-touch-icon" href="static/images/TRISH.png">
  
  <!-- Critical CSS - Load synchronously -->
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/index.css">
  <style>
  /* Sticky header + first column table styles for TSV live view */
  .tsv-table-wrap { overflow:auto; max-height:420px; }
  table.tsv-table { border-collapse: collapse; width: 100%; }
  table.tsv-table th, table.tsv-table td { border: 1px solid #e6e6e6; padding: 8px; vertical-align: top; background: white; }
  /* Keep header text on a single line so header width defines column width */
  table.tsv-table th { white-space: nowrap; position: sticky; top: 0; z-index: 4; background: #f8f8f8; border-right: 1px solid #cfcfcf; }
  /* Sticky first column */
  table.tsv-table th:first-child, table.tsv-table td:first-child { position: sticky; left: 0; z-index: 3; background: #fff; }
  table.tsv-table th:first-child { z-index: 5; }
  /* Allow body cells to wrap at word boundaries (do not split words) and limit cell width */
  table.tsv-table td { white-space: normal; overflow-wrap: normal; word-break: normal; max-width: 300px; }
  table.tsv-table th:first-child, table.tsv-table td:first-child { position: sticky; left: 0; z-index: 3; background: #f8f8f8; }
  table.tsv-table th:first-child { z-index: 5; }
  details.deck-details { margin-bottom: 1rem; border: 1px solid #e6e6e6; border-radius: 6px; padding: 0.5rem; }
  details.deck-details summary { font-weight: 600; cursor: pointer; padding: 0.5rem; }
  .deck-actions { margin: 0.5rem 0 1rem 0; }
  /* Anki filter controls: keep on a single line, prevent overflow */
  .deck-filter-controls { display:flex; align-items:center; gap:0.5rem; flex-wrap:nowrap; }
  .deck-filter-controls select.input { min-width:160px; max-width:360px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .deck-filter-controls .button { white-space:nowrap; }
  @media (max-width:640px) {
    .deck-filter-controls { flex-direction:column; align-items:flex-start; gap:0.25rem; }
    .deck-filter-controls select.input { width:100%; }
  }
  </style>
  
  <!-- Non-critical CSS - Load asynchronously -->
  <link rel="preload" href="static/css/bulma-carousel.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/bulma-slider.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/fontawesome.all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  <!-- Fallback for browsers that don't support preload -->
  <noscript>
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  </noscript>
  
  <!-- Fonts - Optimized loading -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Defer non-critical JavaScript -->
  <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script defer src="static/js/bulma-carousel.min.js"></script>
  <script defer src="static/js/bulma-slider.min.js"></script>
  <script defer src="static/js/index.js"></script>
</head>
<body>


  <!-- Scroll to Top Button -->
  <button class="scroll-to-top" onclick="scrollToTop()" title="Scroll to top" aria-label="Scroll to top">
    <i class="fas fa-chevron-up"></i>
  </button>

  <main id="main-content">
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <!-- TODO: Replace with your paper title -->
            <h1 class="title is-1 publication-title">Totally-Rad Illness Script Hub</h1>
            <div class="is-size-5 publication-authors">
              <!-- TODO: Replace with your paper authors and their personal links -->
              <span class="author-block">
                <a href="mailto:murrx019@umn.edu" target="_blank">Austin Murr</a>
                <br>MD Student
                <br>University of Minnesota Medical School - Twin Cities
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <figure class="image is-128x128 is-inline-block" style="margin-top:0.75rem;">
          <img src="static/images/TRISH.png" alt="TRISH logo">
        </figure>
        <h2 class="title is-3">About TRISH</h2>
        <div class="content has-text-justified">
          <!-- TODO: Replace with your paper abstract -->
          <p>
            <strong>TRISH</strong> <em>(Totally-Rad Illness Script Hub)</em> is one of my primary study tools. Perhaps the best study feature is that TRISH is able to turn illness scripts into Anki cards, complete with tags and text-to-speech.
          </p>
          <p>
            As I create TRISH and update it, you will be able to refer to this page for the most up-to-date version. You can view the up-to-date spreadsheet online there, as well as download the updated Anki decks. I have built in a feature that allows you to add new cards and update old ones without losing your Anki SRS history.
          </p>
            <p>
            Creation of the content is assissted by OpenEvidence. If you want to see the prompt I use, please refer to <a href="/TRISH/oe_prompt.txt" target="_blank" rel="noopener noreferrer" class="has-text-link">oe_prompt.txt</a>. If you use this prompt yourself, note that OpenEvidence seems to max out with about 6 conditions at a time.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Download TRISH Anki Deck -->
  <section class="section" id="anki-download">
    <div class="container is-max-desktop content has-text-centered">
      <h2 class="title">Download TRISH Anki Deck (.apkg)</h2>
      <div style="display:inline-flex;align-items:center;gap:0.75rem;">
        <a id="anki-download-btn" class="button is-large is-info" href="TRISH_Anki/TRISH_v2026.02.17.1345.apkg" download="TRISH_v2026.02.17.1345.apkg" target="_blank" rel="noopener noreferrer">
          <span class="icon" style="margin-right:0.5rem;">
            <!-- Anki SVG icon -->
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3d/Anki-icon.svg">
          </span>
          <span class="version-label">v2026.02.17.1345</span>
        </a>
      </div>
    </div>
  </section>

  <!-- TRISH Decks: collapsible sections with download + TSV live view -->
  <section class="section has-background-light" id="trish-decks">
    <div class="container is-max-desktop content">
      <h2 class="title has-text-centered">View TRISH Tables by Block</h2>
      <div id="decks-container">
        <!-- JS will populate collapsible deck details here -->
      </div>
    </div>
  </section>

  <script>
  (function(){
    const categories = [
      {key: 'Fund', apkg: 'Fund.apkg', tsv: 'fund.tsv', title: 'Fundamentals'},
      {key: 'Skin', apkg: 'Skin.apkg', tsv: 'skin.tsv', title: 'Skin'},
      {key: 'MSK', apkg: 'MSK.apkg', tsv: 'msk.tsv', title: 'Musculoskeletal System'},
      {key: 'NSHB', apkg: 'NSHB.apkg', tsv: 'nshb.tsv', title: 'Nervous System & Human Behavior'},
      {key: 'Cardio', apkg: 'Cardio.apkg', tsv: 'cardio.tsv', title: 'Cardiovascular System'},
      {key: 'Resp', apkg: 'Resp.apkg', tsv: 'resp.tsv', title: 'Respiratory System'},
      {key: 'Renal', apkg: 'Renal.apkg', tsv: 'renal.tsv', title: 'Renal System'},
      {key: 'EndoRepro', apkg: 'EndoRepro.apkg', tsv: 'endorepro.tsv', title: 'Endocrine & Reproductive Systems'},
      {key: 'Heme', apkg: 'Heme.apkg', tsv: 'heme.tsv', title: 'Hematology'},
      {key: 'GI', apkg: 'GI.apkg', tsv: 'gi.tsv', title: 'Gastrointestinal System'}
    ];

    const container = document.getElementById('decks-container');

    // Single global Anki deck download (one .apkg for the whole repo)
    // const globalAnkiDiv = document.createElement('div');
    // globalAnkiDiv.className = 'deck-actions';
    // const globalAnkiBtn = document.createElement('a');
    // globalAnkiBtn.className = 'button is-medium is-info';
    // globalAnkiBtn.textContent = 'Download TRISH Anki Deck (.apkg)';
    // globalAnkiBtn.href = 'TRISH_Anki/TRISH.apkg';
    // globalAnkiBtn.setAttribute('download', '');
    // globalAnkiBtn.target = '_blank';
    // globalAnkiDiv.appendChild(globalAnkiBtn);
    // container.appendChild(globalAnkiDiv);

    function makeTableFromTSV(text){
      const raw = text.replace(/\r/g,'').trim();
      if(!raw) {
        const emptyTable = document.createElement('table');
        emptyTable.className = 'tsv-table';
        return emptyTable;
      }
      const rows = raw.split('\n').map(r => r.split('\t'));
      // normalize header: remove BOM and trim cells
      let header = rows[0].map(h => (h || '').replace(/^\uFEFF/, '').trim());
      // remove trailing empty header columns (these caused the extra 16 columns)
      while(header.length > 1 && header[header.length - 1] === '') header.pop();
      const colCount = header.length;
      // detect index of "More Info" column (case-insensitive, allow small variations)
      const moreInfoIdx = header.findIndex(h => {
        if(!h) return false;
        const s = h.toString().toLowerCase().trim();
        return s === 'more info' || s === 'more_info' || s === 'moreinfo' || s.includes('more info');
      });

      const table = document.createElement('table');
      table.className = 'tsv-table';
      const thead = document.createElement('thead');
      const tbody = document.createElement('tbody');

      // header
      const headerRow = document.createElement('tr');
      header.forEach((h) => {
        const th = document.createElement('th');
        th.textContent = h || '';
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);

      // body: ensure each row has exactly colCount cells (truncate or pad)
      for(let r=1; r<rows.length; r++){
        const tr = document.createElement('tr');
        let cells = rows[r].map(c => (c||'').trim());
        if(cells.length > colCount) cells = cells.slice(0, colCount);
        else if(cells.length < colCount) cells = cells.concat(Array(colCount - cells.length).fill(''));
        for(let i=0;i<colCount;i++){
          const td = document.createElement('td');
          const cellText = cells[i] || '';
          if(i === moreInfoIdx && cellText) {
            const a = document.createElement('a');
            a.href = cellText;
            a.textContent = 'More Info';
            a.target = '_blank';
            a.rel = 'noopener noreferrer';
            td.appendChild(a);
          } else {
            td.textContent = cellText;
          }
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      }
      table.appendChild(thead);
      table.appendChild(tbody);
      return table;
    }

    // Helper: create a stable tag from a string (mirrors Python clean_tag)
    function jsCleanTag(s){
      if (s === "USMLE Classic Presentation"){
        return "Presentation";
      }
      return (s||'').toString().trim().replace(/&/g,'and').replace(/\s+/g,'_');
    }

    categories.forEach(cat => {
      const details = document.createElement('details');
      details.className = 'deck-details has-background-white';
      const summary = document.createElement('summary');
      summary.textContent = cat.title || cat.key;
      details.appendChild(summary);

      const actions = document.createElement('div');
      actions.className = 'deck-actions buttons';

      const dl_tsv = document.createElement('a');
      dl_tsv.className = 'button is-small is-success';
      dl_tsv.textContent = 'Download Spreadsheet (.tsv)';
      dl_tsv.href = 'TRISH_Sheets/' + cat.tsv;
      dl_tsv.setAttribute('download', '');
      dl_tsv.target = '_blank';
      actions.appendChild(dl_tsv);
      // per-deck first-column search input
      const searchInput = document.createElement('input');
      searchInput.type = 'search';
      searchInput.className = 'input is-small';
      searchInput.placeholder = 'Search first column';
      searchInput.style.marginLeft = '0.5rem';
      searchInput.addEventListener('input', function(e){
        const q = (e.target.value || '').trim().toLowerCase();
        const table = details.querySelector('table.tsv-table');
        if(!table) return;
        const body = table.tBodies[0];
        if(!body) return;
        for(let r=0;r<body.rows.length;r++){
          const cell = body.rows[r].cells[0];
          const text = cell ? (cell.textContent || '').trim().toLowerCase() : '';
          body.rows[r].style.display = (!q || text.indexOf(q) !== -1) ? '' : 'none';
        }
      });
      actions.appendChild(searchInput);
      // Column selector and copy button will be shown in a separate "Anki Filters" control below
      const colSelect = document.createElement('select');
      colSelect.className = 'input is-small';
      colSelect.style.marginLeft = '0.5rem';
      colSelect.disabled = true;
      const defaultOpt = document.createElement('option'); defaultOpt.value = 'ALL'; defaultOpt.textContent = 'All Columns'; colSelect.appendChild(defaultOpt);

      // Copy Anki filter button (created but not appended here)
      const copyBtn = document.createElement('button');
      copyBtn.className = 'button is-small is-info';
      copyBtn.textContent = 'Copy Anki Filter';
      copyBtn.style.marginLeft = '0.5rem';
      copyBtn.disabled = true;
            
      // const dl_anki = document.createElement('a');
      // dl_anki.className = 'button is-small is-info';
      // dl_anki.textContent = 'Download Anki Deck (.apkg)';
      // dl_anki.href = 'TRISH_Anki/' + cat.apkg;
      // dl_anki.setAttribute('download', '');
      // dl_anki.target = '_blank';
      // actions.appendChild(dl_anki);

      details.appendChild(actions);

      // Create a separate control area for Anki Filters (separate from condition search)
      const filterDiv = document.createElement('div');
      filterDiv.className = 'deck-filter-controls has-background-light';
      filterDiv.style.padding = '0.5rem';
      filterDiv.style.margin = '0.5rem 0';
      const filterLabel = document.createElement('span');
      filterLabel.style.fontWeight = '600';
      filterLabel.style.marginRight = '0.5rem';
      filterLabel.textContent = 'Anki Filters:';
      filterDiv.appendChild(filterLabel);
      // show friendly dropdown (will be populated after TSV loads)
      filterDiv.appendChild(colSelect);
      filterDiv.appendChild(copyBtn);
      details.appendChild(filterDiv);

      const tableWrap = document.createElement('div');
      tableWrap.className = 'tsv-table-wrap';
      tableWrap.textContent = 'Loading table...';
      details.appendChild(tableWrap);

      container.appendChild(details);

      // fetch TSV
      fetch('TRISH_Sheets/' + cat.tsv).then(r => {
        if(!r.ok) throw new Error('Not found');
        return r.text();
      }).then(txt => {
        tableWrap.textContent = '';

        // Parse header to populate column selector (mirror of makeTableFromTSV header logic)
        const raw = txt.replace(/\r/g,'').trim();
        const rows = raw.split('\n').map(r => r.split('\t'));
        let header = rows[0].map(h => (h || '').replace(/^\uFEFF/, '').trim());
        while(header.length > 1 && header[header.length - 1] === '') header.pop();

        // Populate select with column names (exclude primary and meta columns)
        // We'll include all columns except the first and columns that look like 'Never Miss' or 'More Info'
        const primary = header[0] || '';
        header.forEach((colName) => {
          if(!colName) return;
          const lower = colName.toString().toLowerCase().trim();
          if(colName === primary) return;
          if(lower === 'never miss' || lower === 'more info' || lower === 'more_info' || lower === 'moreinfo') return;
          const opt = document.createElement('option');
          opt.value = jsCleanTag(colName);
          // show compact cleaned tag, full column name available on hover
          opt.textContent = colName;
          opt.title = colName;
          colSelect.appendChild(opt);
        });
        if(colSelect.options.length > 1){ // has additional columns
          colSelect.disabled = false;
        }

        // Enable copy button and attach handler
        copyBtn.disabled = false;
        const blockTagName = (cat.tsv || '').split('.')[0].toUpperCase();
        copyBtn.addEventListener('click', function(){
          const blockTag = `TRISH::Blocks::${jsCleanTag(blockTagName)}`;
          const col = colSelect.value || 'ALL';
          let filter = '';
          if(col === 'ALL'){
            filter = `tag:${blockTag}`;
          } else {
            const colTag = `TRISH::${jsCleanTag(col)}`;
            filter = `tag:${blockTag} tag:${colTag}`;
          }
          // Copy to clipboard
          if(navigator.clipboard && navigator.clipboard.writeText){
            navigator.clipboard.writeText(filter).then(()=>{
              const prev = copyBtn.textContent;
              copyBtn.textContent = 'Copied!';
              setTimeout(()=> copyBtn.textContent = prev, 1500);
            }).catch(()=>{
              alert('Copy failed — here is the filter:\n' + filter);
            });
          } else {
            // Fallback
            prompt('Copy this Anki search filter:', filter);
          }
        });

        const table = makeTableFromTSV(txt);
        tableWrap.appendChild(table);
      }).catch(err => {
        tableWrap.textContent = 'TSV not available: ' + err.message;
      });
    });
  })();
  </script>

  <script>
  function setAnkiVersion(v){
    const btn = document.getElementById('anki-download-btn');
    if(!btn) return;
    btn.href = 'TRISH_Anki/TRISH_' + v + '.apkg';
    btn.setAttribute('download','TRISH_' + v + '.apkg');
    const label = btn.querySelector('.version-label');
    if(label) label.textContent = 'TRISH ' + v;
  }
  document.addEventListener('DOMContentLoaded', function(){
    const sel = document.getElementById('anki-version-select');
    if(!sel) return;
    sel.addEventListener('change', function(e){ setAnkiVersion(e.target.value); });
    // Initialize to selected option or meta tag
    const initial = sel.value || (document.querySelector('meta[name="trish-version"]') || {}).content || 'v2026.01.12.0950';
    // If no options are populated yet, create one with current meta
    if(!sel.querySelector('option')){
      const opt = document.createElement('option'); opt.value = initial; opt.textContent = initial; opt.selected = true; sel.appendChild(opt);
    }
    setAnkiVersion(sel.value || initial);
  });
  </script>

  <section class="section">
    <div class="container is-max-desktop content">
      <h2 class="title">TRISH Update Form</h2>
      <div class="has-text-centered">
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScKFqnG2PQXZVnw63mrzQVzHN_GnkaCulmbemDdhsmSCuoddQ/viewform?embedded=true" width="640" height="944" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
      </div>
    </div>
  </section>


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p class="is-size-7 has-text-right">Version: <span id="trish-version">v2026.02.17.1345</span></p>

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
